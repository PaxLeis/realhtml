<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>realHTML</title>
<style>
  body {
    margin: 0;
    font-family: Arial, sans-serif;
    display: flex;
    flex-direction: column;
    height: 100vh;
    background-color: #222;
    color: #eee;
  }

  /* Top control buttons container */
  #top-controls {
    display: flex;
    padding: 5px 10px;
    background: #444;
    gap: 10px;
    align-items: center;
  }

  #top-controls button {
    padding: 6px 12px;
    font-size: 14px;
    cursor: pointer;
    border: none;
    border-radius: 3px;
    background: #555;
    color: #fff;
  }

  /* Tab bar styles */
  #tabs {
    display: flex;
    background: #444;
    padding: 5px;
    align-items: center;
  }

  .tab {
    background: #666;
    padding: 5px 10px;
    margin-right: 5px;
    border-radius: 3px;
    cursor: pointer;
    display: flex;
    align-items: center;
  }

  .tab.active {
    background: #999;
  }

  .tab input {
    border: none;
    background: transparent;
    color: #fff;
    margin-right: 5px;
    width: 100px;
  }

  .tab button {
    background: none;
    border: none;
    color: #fff;
    cursor: pointer;
  }

  #addTabBtn {
    background: #555;
    border: none;
    color: #fff;
    padding: 5px 10px;
    margin-left: auto;
    cursor: pointer;
    border-radius: 3px;
  }

  /* Main container for editors and preview */
  #main {
    display: flex;
    flex: 1;
    height: calc(100vh - 80px); /* Adjust for top controls and tab bar */
  }

  #editor-container {
    width: 50%;
    display: flex;
    flex-direction: column;
  }

  #buttons {
    padding: 10px;
    background: #333;
    display: flex;
    gap: 10px;
  }

  #code-editors {
    flex: 1;
    display: flex;
    flex-direction: column;
  }

  textarea {
    flex: 1;
    width: 100%;
    border: none;
    resize: none;
    padding: 10px;
    font-family: monospace;
    font-size: 14px;
    background-color: #222;
    color: #eee;
  }

  #preview-container {
    width: 50%;
    height: 100%;
    border-left: 1px solid #555;
    background-color: black;
    position: relative;
  }

  #iframe-preview {
    width: 100%;
    height: 100%;
    border: none;
  }
</style>
</head>
<body>

<!-- Control buttons (New Tab and Fullscreen) on same row -->
<div id="top-controls">
  <button id="addTabBtn">+ New Tab</button>
  <button id="fullscreenToggleBtn">Toggle Pullscreen</button>
</div>

<!-- Tab bar -->
<div id="tabs"></div>

<!-- Main editor and preview -->
<div id="main">
  <div id="editor-container">
    <div id="code-editors">
      <textarea id="htmlCode" placeholder="HTML code here..."></textarea>
      <textarea id="cssCode" placeholder="CSS code here..."></textarea>
      <textarea id="jsCode" placeholder="JavaScript code here..."></textarea>
    </div>
  </div>
  <div id="preview-container">
    <iframe id="iframe-preview"></iframe>
  </div>
</div>

<script>
  const tabsContainer = document.getElementById('tabs');
  const addTabBtn = document.getElementById('addTabBtn');
  const htmlCode = document.getElementById('htmlCode');
  const cssCode = document.getElementById('cssCode');
  const jsCode = document.getElementById('jsCode');
  const iframe = document.getElementById('iframe-preview');
  const fullscreenBtn = document.getElementById('fullscreenToggleBtn');

  let tabs = [];
  let currentTabId = null;

  // Load tabs from localStorage
  function loadTabs() {
    const saved = localStorage.getItem('codeTabs');
    if (saved) {
      try {
        tabs = JSON.parse(saved);
      } catch(e) {
        console.error('Error parsing saved tabs', e);
        tabs = [];
      }
    }
    if (tabs.length === 0) {
      createTab('Default');
    } else {
      loadTab(tabs[0].id);
    }
    renderTabs();
  }

  // Save all tabs to localStorage
  function saveTabs() {
    localStorage.setItem('codeTabs', JSON.stringify(tabs));
  }

  // Create a new tab
  function createTab(name) {
    const id = Date.now().toString();
    const newTab = {
      id,
      name,
      html: '',
      css: '',
      js: ''
    };
    tabs.push(newTab);
    loadTab(id);
    renderTabs();
    saveTabs();
  }

  // Load a tab's code into editors
  function loadTab(id) {
    const tab = tabs.find(t => t.id === id);
    if (!tab) return;
    currentTabId = id;
    htmlCode.value = tab.html;
    cssCode.value = tab.css;
    jsCode.value = tab.js;
    setActiveTab(id);
    updatePreview();
  }

  // Save current code into active tab
  function saveCurrentTab() {
    const tab = tabs.find(t => t.id === currentTabId);
    if (tab) {
      tab.html = htmlCode.value;
      tab.css = cssCode.value;
      tab.js = jsCode.value;
      saveTabs();
    }
  }

  // Render tab buttons
  function renderTabs() {
    document.querySelectorAll('.tab').forEach(t => t.remove());
    tabs.forEach(tab => {
      const tabBtn = document.createElement('div');
      tabBtn.className = 'tab' + (tab.id === currentTabId ? ' active' : '');

      // Name input
      const nameInput = document.createElement('input');
      nameInput.type = 'text';
      nameInput.value = tab.name;
      nameInput.title = 'Rename tab';
      nameInput.addEventListener('change', () => {
        tab.name = nameInput.value;
        saveTabs();
        renderTabs();
      });
      tabBtn.appendChild(nameInput);

      // Delete button
      const delBtn = document.createElement('button');
      delBtn.innerHTML = 'Ã—';
      delBtn.title = 'Delete tab';
      delBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        deleteTab(tab.id);
      });
      tabBtn.appendChild(delBtn);

      // Switch tab on click
      tabBtn.addEventListener('click', () => {
        saveCurrentTab();
        loadTab(tab.id);
      });

      // Add to DOM
      tabsContainer.appendChild(tabBtn);
    });
  }

  function setActiveTab(id) {
    currentTabId = id;
    renderTabs();
  }

  function deleteTab(id) {
    tabs = tabs.filter(t => t.id !== id);
    if (tabs.length > 0) {
      loadTab(tabs[0].id);
    } else {
      createTab('New Tab');
    }
    saveTabs();
  }

  // Add new tab
  addTabBtn.addEventListener('click', () => {
    saveCurrentTab();
    createTab('New Tab');
  });

  // Auto-update preview
  htmlCode.addEventListener('input', updatePreview);
  cssCode.addEventListener('input', updatePreview);
  jsCode.addEventListener('input', updatePreview);

  // Load tabs on page load
  window.onload = () => {
    loadTabs();
  };

  // Update preview
  function updatePreview() {
    const html = htmlCode.value;
    const css = `<style>${cssCode.value}</style>`;
    const js = `<script>${jsCode.value}<\/script>`;
    const content = `${html}\n${css}\n${js}`;
    const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
    iframeDoc.open();
    iframeDoc.write(content);
    iframeDoc.close();
  }

  // Toggle fullscreen
fullscreenBtn.addEventListener('click', () => {
    if (!document.fullscreenElement) {
      iframe.requestFullscreen().catch((err) => {
        alert(`Error attempting to enable full-screen mode: ${err.message} (${err.name})`);
      });
    } else {
      document.exitFullscreen();
    }
  });
</script>
</body>
</html>
